{"version":3,"sources":["webpack:///./src/assets/images/empty-car.png","webpack:///./node_modules/core-js/modules/es.string.includes.js","webpack:///./src/views/shopcart/ShopCart.vue?9528","webpack:///./node_modules/core-js/internals/is-regexp.js","webpack:///./node_modules/core-js/internals/not-a-regexp.js","webpack:///./src/views/shopcart/ShopCart.vue","webpack:///./src/views/shopcart/ShopCart.vue?d899","webpack:///./node_modules/core-js/internals/correct-is-regexp-logic.js","webpack:///./node_modules/core-js/modules/es.array.includes.js"],"names":["module","exports","$","notARegExp","requireObjectCoercible","correctIsRegExpLogic","target","proto","forced","includes","searchString","String","this","indexOf","arguments","length","undefined","isObject","classof","wellKnownSymbol","MATCH","it","isRegExp","TypeError","style","class","src","alt","default","$store","state","cartCount","ref","groupChange","result","list","item","index","right-width","key","right","square","icon","type","deleteGood","id","name","goods","cover_url","title","stock","price","integer","min","max","model-value","num","async-change","onChange","total","onSubmit","button-text","allCheck","checked","checkAll","round","color","block","goTo","components","NavBar","setup","store","router","init","loading","message","forbidClick","then","res","console","log","data","filter","n","is_checked","map","clear","value","detail","forEach","cart_ids","push","path","dispatch","sum","parseInt","parseFloat","fail","render","__scopeId","METHOD_NAME","regexp","error1","error2","$includes","addToUnscopables","el"],"mappings":"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","file":"js/chunk-5c817ea4.93854a1c.js","sourcesContent":["module.exports = __webpack_public_path__ + \"img/empty-car.9fd061a7.png\";","'use strict';\nvar $ = require('../internals/export');\nvar notARegExp = require('../internals/not-a-regexp');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar correctIsRegExpLogic = require('../internals/correct-is-regexp-logic');\n\n// `String.prototype.includes` method\n// https://tc39.es/ecma262/#sec-string.prototype.includes\n$({ target: 'String', proto: true, forced: !correctIsRegExpLogic('includes') }, {\n  includes: function includes(searchString /* , position = 0 */) {\n    return !!~String(requireObjectCoercible(this))\n      .indexOf(notARegExp(searchString), arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./ShopCart.vue?vue&type=style&index=0&id=fbced766&scoped=true&lang=scss\"","var isObject = require('../internals/is-object');\nvar classof = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar MATCH = wellKnownSymbol('match');\n\n// `IsRegExp` abstract operation\n// https://tc39.es/ecma262/#sec-isregexp\nmodule.exports = function (it) {\n  var isRegExp;\n  return isObject(it) && ((isRegExp = it[MATCH]) !== undefined ? !!isRegExp : classof(it) == 'RegExp');\n};\n","var isRegExp = require('../internals/is-regexp');\n\nmodule.exports = function (it) {\n  if (isRegExp(it)) {\n    throw TypeError(\"The method doesn't accept regular expressions\");\n  } return it;\n};\n","<template>\r\n    <div>\r\n        <nav-bar class=\"nav-bar\">\r\n            <template v-slot:default>\r\n                购物车(<span style=\"color: red\"> {{ $store.state.cartCount }} </span>)\r\n            </template>\r\n        </nav-bar>\r\n\r\n        <div class=\"cart-box\">\r\n            <div class=\"cart-body\">\r\n                <van-checkbox-group\r\n                    ref=\"checkboxGroup\"\r\n                    @change=\"groupChange\"\r\n                    v-model=\"result\"\r\n                >\r\n\r\n                    <van-swipe-cell\r\n                        :right-width=\"50\"\r\n                        v-for=\"(item, index) in list\"\r\n                        :key=\"index\"\r\n                    >\r\n                        <div class=\"good-item\">\r\n                            <van-checkbox :name=\"item.id\" />\r\n\r\n                            <div class=\"good-img\">\r\n                                <img :src=\"item.goods.cover_url\" alt=\"\" />\r\n                            </div>\r\n\r\n                            <div class=\"good-desc\">\r\n                                <div class=\"good-title\">\r\n                                    <span>{{ item.goods.title }}</span>\r\n                                    <span>x{{ item.goods.stock }}</span>\r\n                                </div>\r\n\r\n                                <div class=\"good-btn\">\r\n                                    <div class=\"price\">\r\n                                        <small>¥</small>{{ item.goods.price + '.00' }}\r\n                                    </div>\r\n                                    <van-stepper\r\n                                        integer\r\n                                        :min=\"1\"\r\n                                        :max=\"item.goods.stock\"\r\n                                        :model-value=\"item.num\"\r\n                                        :name=\"item.id\"\r\n                                        async-change\r\n                                        @change=\"onChange\"\r\n                                    />\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <template #right>\r\n                            <van-button\r\n                                square\r\n                                icon=\"delete\"\r\n                                type=\"danger\"\r\n                                class=\"delete-button\"\r\n                                @click=\"deleteGood(item.id)\"\r\n                            />\r\n                        </template>\r\n                    </van-swipe-cell>\r\n\r\n                </van-checkbox-group>\r\n            </div>\r\n\r\n            <van-submit-bar\r\n                class=\"submit-all\"\r\n                :price=\"total * 100\"\r\n                @submit=\"onSubmit\"\r\n                button-text=\"结算\"\r\n            >\r\n                <van-checkbox @click=\"allCheck\" v-model:checked=\"checkAll\">全选\r\n                </van-checkbox>\r\n            </van-submit-bar>\r\n\r\n            <div class=\"empty\" v-if=\"!list.length\">\r\n                <img\r\n                    class=\"empty-cart\"\r\n                    src=\"~assets/images/empty-car.png\"\r\n                    alt=\"空购物车\"\r\n                />\r\n                <div class=\"title\">购物车空空如也</div>\r\n                <van-button round color=\"#1baeae\" type=\"primary\" block @click=\"goTo\">前往选购\r\n                </van-button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n\r\n<script>\r\nimport NavBar from 'components/common/navbar/NavBar.vue'\r\nimport {ref, reactive, toRefs, onMounted, computed} from 'vue';\r\nimport { useStore } from 'vuex';\r\nimport { useRouter } from 'vue-router';\r\nimport { getCart, deleteCartItem, checkedCart, modifyCart } from 'network/cart';\r\nimport { Toast } from 'vant';\r\n\r\nexport default {\r\n    name: 'ShopCart',\r\n    components: {\r\n        NavBar,\r\n    },\r\n    setup () {\r\n        const store = useStore();\r\n        const router = useRouter();\r\n        \r\n        // 数据模型 （状态）\r\n        const state = reactive({\r\n            list:[],\r\n            result: [],  // 选中的商品的 id\r\n            checkAll: true,\r\n        })\r\n\r\n\r\n        // 初始化购物车数据\r\n        const init = ()=>{\r\n            Toast.loading({message:'加载中...', forbidClick: true});\r\n\r\n            getCart('include=goods').then(res =>{\r\n                console.log(res.data);\r\n                state.list = res.data;\r\n\r\n                state.result = res.data.filter(n=>n.is_checked == 1).map(item => item.id);\r\n\r\n                Toast.clear();\r\n            })\r\n        }\r\n\r\n        onMounted (()=>{\r\n            init();\r\n        })\r\n\r\n        // 异步改变购物车数量\r\n        const onChange = (value, detail)=>{\r\n            Toast.loading({message:'修改中...', forbidClick:true});\r\n\r\n            modifyCart(detail.name, {num: value}).then(res=>{\r\n                //将在 onMounted 中的 list 中的 num 也要改\r\n                state.list.forEach(item => {\r\n                    if(item.id == detail.name) {\r\n                        item.num = value;\r\n                    }\r\n                })\r\n                Toast.clear();\r\n            })\r\n        }\r\n\r\n        // 复选框改变处理\r\n        const groupChange = (result)=>{\r\n            if(result.length == state.list.length) {\r\n                state.checkAll = true;\r\n            }else{\r\n                state.checkAll = false;\r\n            }\r\n            // console.log(result);\r\n            state.result = result;\r\n            checkedCart({cart_ids:result});\r\n        }\r\n\r\n        const allCheck = ()=>{\r\n            if(!state.checkAll) {\r\n                state.result = state.list.map(item=>item.id)\r\n                state.checkAll = true;\r\n            }else {\r\n                state.result =[];\r\n                state.checkAll = false;\r\n            }\r\n        }\r\n\r\n        // 前往购物\r\n        const goTo = () =>{\r\n            router.push({path: '/home'});\r\n        }\r\n\r\n        // 删除商品\r\n        const deleteGood = (id) => {\r\n            deleteCartItem(id).then(res=>{\r\n                init();\r\n                store.dispatch('updateCart');\r\n            });\r\n        }\r\n\r\n        // 通过计算属性计算总价\r\n        const total = computed(()=>{\r\n            let sum = 0;\r\n\r\n            state.list.filter(item=> state.result.includes(item.id))\r\n                .forEach(item =>{\r\n                    sum += parseInt(item.num) * parseFloat(item.goods.price);\r\n                })\r\n            return sum;\r\n        })\r\n\r\n        // 创建订单\r\n        const onSubmit = ()=>{\r\n            if (state.result.length == 0) {\r\n                Toast.fail('请选择商品进行结算');\r\n                return;\r\n            } else {\r\n                router.push({path:'/createorder'});\r\n            }\r\n        }\r\n\r\n        return {\r\n            total,\r\n            goTo,\r\n            onSubmit,\r\n            onChange,\r\n            allCheck,\r\n            deleteGood,\r\n            groupChange,\r\n            ...toRefs(state),\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.cart-box {\r\n    .cart-body {\r\n        margin: 60px 0 100px 0;\r\n        padding-left: 10px;\r\n\r\n        .good-item {\r\n            display: flex;\r\n            .good-img {\r\n                img {\r\n                    width:100px;\r\n                    height:auto;\r\n                }\r\n            }\r\n            .good-desc {\r\n                display: flex;\r\n                flex-direction: column;\r\n                justify-content: space-between;\r\n                flex: 1;\r\n                padding: 20px;\r\n\r\n                .good-title {\r\n                    display: flex;\r\n                    justify-content: space-between;\r\n                }\r\n\r\n                .good-btn {\r\n                    display: flex;\r\n                    justify-content: space-between;\r\n\r\n                    .price {\r\n                        font-size: 16px;\r\n                        color: red;\r\n                        line-height: 28px;\r\n                    }\r\n\r\n                    .van-icon-delete {\r\n                        font-size: 20px;\r\n                        margin-top: 4px;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        .delete-button {\r\n            width: 50px;\r\n            height: 100%;\r\n        }\r\n    }\r\n\r\n    .empty {\r\n        width: 50%;\r\n        margin: 0 auto;\r\n        text-align: center;\r\n        margin-top: 200px;\r\n\r\n        .empty-cart {\r\n            width: 150px;\r\n            margin-bottom: 20px;\r\n        }\r\n        .van-icon-smile-o {\r\n            font-size: 50px;    \r\n        }\r\n        .title {\r\n            font-size: 16px;\r\n            margin-bottom: 20px;\r\n        }\r\n    }\r\n\r\n    .submit-all {\r\n        margin-bottom: 50px;\r\n\r\n        .van-checkbox {\r\n            margin-left: 0px\r\n        }\r\n        .van-submit-bar__text {\r\n            margin-right: 10px\r\n        }\r\n        .van-submit-bar__button {\r\n            background:red;\r\n        }\r\n    }\r\n\r\n    .van-checkbox__icon--checked .van-icon {\r\n        background-color:red;\r\n        border-color: red;\r\n    }\r\n}\r\n</style>\r\n","import { render } from \"./ShopCart.vue?vue&type=template&id=fbced766&scoped=true\"\nimport script from \"./ShopCart.vue?vue&type=script&lang=js\"\nexport * from \"./ShopCart.vue?vue&type=script&lang=js\"\n\nimport \"./ShopCart.vue?vue&type=style&index=0&id=fbced766&scoped=true&lang=scss\"\nscript.render = render\nscript.__scopeId = \"data-v-fbced766\"\n\nexport default script","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar MATCH = wellKnownSymbol('match');\n\nmodule.exports = function (METHOD_NAME) {\n  var regexp = /./;\n  try {\n    '/./'[METHOD_NAME](regexp);\n  } catch (error1) {\n    try {\n      regexp[MATCH] = false;\n      return '/./'[METHOD_NAME](regexp);\n    } catch (error2) { /* empty */ }\n  } return false;\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar $includes = require('../internals/array-includes').includes;\nvar addToUnscopables = require('../internals/add-to-unscopables');\n\n// `Array.prototype.includes` method\n// https://tc39.es/ecma262/#sec-array.prototype.includes\n$({ target: 'Array', proto: true }, {\n  includes: function includes(el /* , fromIndex = 0 */) {\n    return $includes(this, el, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.es/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('includes');\n"],"sourceRoot":""}