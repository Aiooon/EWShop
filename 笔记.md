# 详细步骤

## 1. 使用 vue-cli 创建项目

```javascript
vue create projectname
```

### Project setup

```javascript
npm install
```

### Compiles and hot-reloads for development

```javascript
npm run serve
```

### Compiles and minifies for production

```javascript
npm run build
```

### Customize configuration

See [Configuration Reference](https://cli.vuejs.org/config/).



## 2. 初始化项目目录，创建路径别名

### 初始化项目目录

- 在 `components` 文件夹下创建两个子目录。`common` 目录用于编写公用组件，这些组件对于项目依赖很小，即使脱离了项目也可在别处应用，`content` 用于编写在这个项目中公用的组件，脱离项目后不可再使用。
- 在 `views` 文件夹下为每个页面创建文件夹，在其中编写每个页面对应的组件

![](https://raw.githubusercontent.com/Aiooon/blogImg/main/img/20210609205058.png)

### 创建路径别名

为了防止在编码中路径嵌套过深，需要为常用路径创建别名，例如：

``` javascript
// @ 是webpack提供的别名，代表/src
import HelloWorld from '@/components/HelloWorld.vue'
```

新建 `vue.config.js` 文件，并在其中添加以下代码：

```javascript
// 设置目录别名，防止路径过深
// 起别名的时候需要借助 webpack
// 在 vue 配置文件中中引入 webpack
module.exports = {
    configureWebpack: {
        resolve: {  // 设置别名，重启服务后生效
            alias: {
                'assets': '@/assets',
                'components':'@/components',
                'network':'@/network',
                'utils':'@/utils',
                'views':'@/views',
            }
        }
    },
    // 打包的输出路径
    publicPath: './'
}
```

在编码中要注意，有些地方访问别名时前面需要加 `~` ：

```javascript
<template>
  <div class="home">
    <div class="demo">this is a test</div>
    <!-- 在模板中访问别名时需要加 ~，如 ~assets -->
    <img src="~assets/images/2.png">
    <img :src="imgsrc">
    <img alt="Vue logo" src="~assets/logo.png">
    <HelloWorld msg="Welcome to Your Vue.js App"/>
  </div>
</template>

<style scoped>
.demo {
  /* 在 style 中访问别名时也需要加 ~ */
  background: url('~assets/images/2.png') no-repeat;
  width: 400px;
  height: 400px;
  color: var(--color-high-text);
}
</style>

```



## 3. 初始化项目的全局样式内容

`assets` 目录下用于存放项目的公用资源，例如图片 `images` 和全局样式 `css` ，新建这两个文件夹。

![](https://raw.githubusercontent.com/Aiooon/blogImg/main/img/20210609210441.png)

对于全局样式，[这里](https://github.com/necolas/normalize.css)提供了一套通用的全局样式，直接将其中的 `normalize.css` 拷贝到 `css` 目录下即可，然后新建 `base.css` 文件，在这里编写我们自己定义的全局样式：

```css
@import "./normalize.css";

:root {
    --color-text: #666;
    --color-high-text: #42bBaa;
    --color-tint:#42b983;
    --color-background:#FFFFFF;
    --font-size:14px;
    --line-height:1.5;
}

*,  /* 设置所有元素 */
*::before,*::after {
    margin:0;
    padding:0;
    box-sizing: border-box;
}

body {
    user-select:none; /* 禁止用户选择中文件或图片 */;
    background: var(--color-background);
    color:var(--color-text);
    width:100vw;    /* 占整个设备的宽度 */
}

a {
    color:var(--color-text);
    text-decoration: none;
}

.left {
    float:left;
}

.right {
    float:right;
}

img {
    max-width: 100% !important;
    height: auto !important;
}
```

**注意**，在 `base.css` 文件中首行添加了引用：

```css
@import "./normalize.css";
```

这样，在后续引用 `base.css` 的文件中，也可以使用 `normalize.css` 中的样式。

**注意**，最好不要直接在 `normalize.css` 中修改或者添加样式，因为该项目还在更新中，如果后续直接将新的文件拷贝过来，就会覆盖掉我们自己编写的内容。



## 4. 初始化项目，封装网络请求

前端项目通过网络请求直接调用后台提供的接口，因此需要为每个页面单独封装网络请求

首先创建 `network` 目录，在该目录下，创建 `reques.js` 文件，用来编写通用内容，之后为每个页面单独新建文件，封装这个页面的网络请求。

![](https://raw.githubusercontent.com/Aiooon/blogImg/main/img/20210609211913.png)

 `reques.js` 中编写所有页面通用的网络请求方法

``` javascript
// 通用内容
// 网络请求 axios 插件
import axios from 'axios'

export function request(config) {
    const instance = axios.create({
        baseURL: 'https://api.shop.eduwork.cn',
        timeout: 5000
    })

    // 请求拦截
    instance.interceptors.request.use(config=>{
        // 如果有一个接口需要认证才可以访问，就这里统一设置

        // 直接放行
        return config;
    }, err=>{

    })

    // 响应拦截
    instance.interceptors.response.use(res=>{
        console.log(res.data);
        return res.data ? res.data : res;
    }, err=>{
        // 如果有需要授权才可以访问的接口，统一去login授权

        // 如果有错误，这里会处理并显示错误信息

    })

    return instance(config);
}
```

然后后续再为每个页面单独新建文件，添加这个页面的网络请求方法。例如对于主页，创建 `home.js` ，并引用 `reques.js` 中的通用方法：

```javascript
import {request} from './request'

export function getHomeAllData() {
    return request({
        url: '/api/index'
    })
}
```



## 5. 制作导航菜单

首先为每个页面新建组件：

![](https://raw.githubusercontent.com/Aiooon/blogImg/main/img/20210610102428.png)

然后在 `rouyer/index.js` 中给每个页面添加路由

**注意**，在添加路由时，我们不使用 `import Home from '../views/Home.vue` 这种方式，因为这样添加的组件无法实现[懒加载](https://router.vuejs.org/zh/guide/advanced/lazy-loading.html#%E6%8A%8A%E7%BB%84%E4%BB%B6%E6%8C%89%E7%BB%84%E5%88%86%E5%9D%97)。

添加路由：

```javascript
const Home = () => import('../views/Home/Home');
const Category = () => import('../views/category/Category');
const Detail = () => import('../views/detail/Detail');
const Profile = () => import('../views/profile/Profile');
const ShopCart = () => import('../views/shopcart/ShopCart');


const routes = [
  {
    path: '/',
    name: 'DefaultHome',
    component: Home
  },
  {
    path: '/home',
    name: 'Home',
    component: Home
  },
  {
    path: '/category',
    name: 'Category',
    component: Category
  },
  {
    path: '/detail',
    name: 'Detail',
    component: Detail
  },
  {
    path: '/shopcart',
    name: 'ShopCart',
    component: ShopCart
  },
  {
    path: '/profile',
    name: 'Profile',
    component: Profile
  },
]
```

然后在 `App.vue` 中使用 `<<router-link>` :

```javascript
<template>
  <router-view/>
  <div id="nav">
    <router-link to="/">首页</router-link>
    <router-link to="/category">分类</router-link>
    <router-link to="/shopcart">购物车</router-link>
    <router-link to="/profile">我的</router-link>
  </div>
</template>
```

因为导航属于通用组件，其实可以单独写在 `../components/common` 或 `../components/content` 下，这里为了方便，直接写在 `App.vue` 里。

现在的效果：

![](https://raw.githubusercontent.com/Aiooon/blogImg/main/img/20210610105514.png)

接下来要更改导航的样式，添加图标，使界面更美观。图标可以在[这里](https://www.iconfont.cn/)找到。选好需要的图标后，选择下载代码

![](https://raw.githubusercontent.com/Aiooon/blogImg/main/img/20210610133153.png)

将下载的文件解压后，把字体文件拷贝到项目中的 `css` 目录下

![](https://raw.githubusercontent.com/Aiooon/blogImg/main/img/20210610133552.png)

在 `iconfont.css` 文件中就可以看到我们刚才下载的图标字体样式：

```javascript
.iconfont {
  font-family: "iconfont" !important;
  font-size: 16px;
  font-style: normal;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.icon-shouye:before {
  content: "\e677";
}

.icon-yonghu:before {
  content: "\e607";
}

.icon-fenlei:before {
  content: "\e611";
}

.icon-gouwuchezhengpin:before {
  content: "\e610";
}
```

后面在组件的 `<style>` 中引入这个样式 `@import "assets/css/iconfont.css";` ，就可以直接使用。

```javascript
<!-- App.vue -->

<template>
  <router-view/>
  <div id="nav">
    <router-link class="tab-bar-item" to="/">
      <div class="icon"><i class="iconfont icon-shouye"></i></div>
      <div>首页</div>
    </router-link>

    <router-link class="tab-bar-item" to="/category">
      <div class="icon"><i class="iconfont icon-fenlei"></i></div>
      <div>分类</div>
    </router-link>

    <router-link class="tab-bar-item" to="/shopcart">
      <div class="icon"><i class="iconfont icon-gouwuchezhengpin"></i></div>
      <div>购物车</div>
    </router-link>

    <router-link class="tab-bar-item" to="/profile">
      <div class="icon"><i class="iconfont icon-yonghu"></i></div>
      <div>我的</div>
    </router-link>
  </div>
</template>
```

现在的效果：

![](https://raw.githubusercontent.com/Aiooon/blogImg/main/img/20210610134925.png)

添加对应的样式：

```javascript
// App.vue

#nav {
  background-color: #f6f6f6;
  display: flex;
  position: fixed;
  left: 0%;
  right: 0%;
  bottom: 0%;
  box-shadow: 0 -3px 1px rgba($color: #000000, $alpha: 0.1);

  a {
    // font-weight: bold;
    color: var(--color-text);

    &.router-link-exact-active {
      color: #42b983;
    }
  }

  .tab-bar-item {
    flex: 1;
    text-align: center;
    height: 50px;
    font-size: var(--font-size);
  }
  .tab-bar-item .icon {
    width: 24px;
    height: 24px;
    margin-top: 5px;
    vertical-align: middle;
    display: inline-block;  // 将块级元素转为行级块
  }
}
```

现在的效果：

![](https://raw.githubusercontent.com/Aiooon/blogImg/main/img/20210610140731.png)



## 6. 制作标题栏

标题栏是一个在每个页面中都要用到的组件，因此可以写在 `components\common` 下，新建 `NavBar.vue` 组件

```javascript
// NavBar.vue

<template>
    <div class="nav-bar">
        <div class="left" @click="goback">
            <slot name="left">
                <img src="~assets/images/left.png">
            </slot>
        </div>
        <div class="center"><slot>EWshop</slot></div>
        <div class="right"><slot name="right"></slot></div>
    </div>
</template>
```

标题栏主要由三部分组成，左边是一个返回键，中间是当前页面标题，右边默认为空，可以将次级菜单放在这里

添加标题栏样式：

```css
// NavBar.vue

<style scoped>

.nav-bar {
    display: flex;
    background-color: var(--color-tint);
    color: #FFFFFF;
    position: fixed;
    left: 0%;
    right: 0%;
    top: 0%;
    z-index: 9;
    height: 45px;
    line-height: 45px;
    text-align: center;
    box-shadow: 0 3px 0px rgba(100, 100, 100, 0.1);
}

.left, .right {
    width: 60px;
}

.left img {
    width: 45px;
    padding: 12px;
}

.center {
    /* background-color: olive; */
    flex: 1;
}

</style>
```

为了实现标题栏返回键返回上一级的功能，需要添加 `on-click` 方法，通过全局路由的历史模式，返回上一个页面：

```javascript
// NavBar.vue

<script>
import { useRouter } from 'vue-router';

export default {
    name: "NavBar",

    setup() {
        const router = useRouter();

        const goback = () => {
            router.go(-1);
        }
        return {
            goback
        }
    }
}
</script>
```

然后在每个页面组件中添加标题栏组件

在 `<script>` 中引入 `NavBar` ：

```javascript
<script>
import NavBar from 'components/common/navbar/NavBar.vue'

export default {
    name: 'Home'
    components: {
        NavBar 
    }
}
</script>
```

在 `<template>` 中添加组件：

```javascript
<template>
    <div>
        <nav-bar>
            <template v-slot:default>个人中心</template>
        </nav-bar>
    </div>
</template>
```

现在的效果：

![](https://raw.githubusercontent.com/Aiooon/blogImg/main/img/%E9%A1%B5%E9%9D%A2%E8%B7%B3%E8%BD%AC%E8%BF%94%E5%9B%9E.gif)

现在，我们还希望当页面发生跳转时，网页的标题也随之变化。实现这个功能，需要在路由中添加全局导航守卫。

首先给每个路由添加一个元元素 `meta.title`：

```javascript
const routes = [
  {
    path: '/',
    name: 'DefaultHome',
    component: Home,
    meta: {
      title: '图书商城-首页'
    }
  },
  {
    path: '/home',
    name: 'Home',
    component: Home,
    meta: {
      title: '图书商城-首页'
    }
  },
  {
    path: '/category',
    name: 'Category',
    component: Category,
    meta: {
      title: '图书商城-分类'
    }
  },
  {
    path: '/detail',
    name: 'Detail',
    component: Detail,
    meta: {
      title: '图书商城-商品详情'
    }
  },
  {
    path: '/shopcart',
    name: 'ShopCart',
    component: ShopCart,
    meta: {
      title: '图书商城-购物车'
    }
  },
  {
    path: '/profile',
    name: 'Profile',
    component: Profile,
    meta: {
      title: '图书商城-个人中心'
    }
  },
]

```

然后设置全局导航守卫，当页面发生跳转时更新网页的 `title`:

```javascript
// 全局导航守卫，页面跳转时更新网页 title
router.beforeEach((to, from, next) => {
  // todo 如果没有登录，在这里login
  next();
  document.title = to.meta.title;
})
```

现在网页的标题也会实时更新了。

